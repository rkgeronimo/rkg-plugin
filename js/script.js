"use strict";!function(f){var e="Class";"0"!==f.version.charAt(0)&&(e="Layer"),f.EdgeMarker=f[e].extend({options:{distanceOpacity:!1,distanceOpacityFactor:4,layerGroup:null,rotateIcons:!0,findEdge:function(e){return f.bounds([0,0],e.getSize())},icon:f.icon({iconUrl:f.Icon.Default.imagePath+"/edge-arrow-marker.png",clickable:!0,iconSize:[48,48],iconAnchor:[24,24]})},initialize:function(e){f.setOptions(this,e)},addTo:function(e){return"function"!=typeof(this._map=e)._getFeatures&&f.extend(e,{_getFeatures:function(){var e=[];for(var t in this._layers)void 0!==this._layers[t].getLatLng&&e.push(this._layers[t]);return e}}),e.on("move",this._addEdgeMarkers,this),e.on("viewreset",this._addEdgeMarkers,this),this._addEdgeMarkers(),e.addLayer(this),this},destroy:function(){this._map&&this._borderMarkerLayer&&(this._map.off("move",this._addEdgeMarkers,this),this._map.off("viewreset",this._addEdgeMarkers,this),this._borderMarkerLayer.clearLayers(),this._map.removeLayer(this._borderMarkerLayer),delete this._map._getFeatures,this._borderMarkerLayer=void 0)},onClick:function(e){this._map.setView(e.target.options.latlng,this._map.getZoom())},onAdd:function(){},_borderMarkerLayer:void 0,_addEdgeMarkers:function(){void 0===this._borderMarkerLayer&&(this._borderMarkerLayer=new f.LayerGroup),this._borderMarkerLayer.clearLayers();var e=[];e=null!=this.options.layerGroup?this.options.layerGroup.getLayers():this._map._getFeatures();for(var t=this.options.findEdge(this._map),o=this.options.icon.options.iconSize[0],n=this.options.icon.options.iconSize[1],r=0;r<e.length;r++){var a=this._map.latLngToContainerPoint(e[r].getLatLng());if(a.y<t.min.y||a.y>t.max.y||a.x>t.max.x||a.x<t.min.x){var i,c=a.x,s=a.y,l=t.getCenter(),d=Math.atan2(l.y-s,l.x-c),u=Math.atan2(l.y-t.min.y,l.x-t.min.x);i=Math.abs(d)>u&&Math.abs(d)<Math.PI-u?s<l.y?(s=t.min.y+n/2,c=l.x-(l.y-s)/Math.tan(Math.abs(d)),a.y-t.y):(s=t.max.y-n/2,c=l.x-(s-l.y)/Math.tan(Math.abs(d)),-a.y):c<l.x?(c=t.min.x+o/2,s=l.y-(l.x-c)*Math.tan(d),-a.x):(c=t.max.x-o/2,s=l.y+(c-l.x)*Math.tan(d),a.x-t.x),s<t.min.y+n/2?s=t.min.y+n/2:s>t.max.y-n/2&&(s=t.max.y-n/2),c>t.max.x-o/2?c=t.max.x-o/2:c<o/2&&(c=t.min.x+o/2);var g=this.options;if(this.options.distanceOpacity&&(g.fillOpacity=(100-i/this.options.distanceOpacityFactor)/100),this.options.rotateIcons){var p=d/Math.PI*180;g.angle=p}var m={latlng:e[r].getLatLng()};g=f.extend({},g,m);var h=f.rotatedMarker(this._map.containerPointToLatLng([c,s]),g).addTo(this._borderMarkerLayer);h.on("click",this.onClick,h)}}this._map.hasLayer(this._borderMarkerLayer)||this._borderMarkerLayer.addTo(this._map)}}),f.RotatedMarker=f.Marker.extend({options:{angle:0},statics:{TRANSFORM_ORIGIN:f.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","OTransformOrigin","MozTransformOrigin","msTransformOrigin"])},_initIcon:function(){f.Marker.prototype._initIcon.call(this),this._icon.style[f.RotatedMarker.TRANSFORM_ORIGIN]="50% 50%"},_setPos:function(e){if(f.Marker.prototype._setPos.call(this,e),f.DomUtil.TRANSFORM)this._icon.style[f.DomUtil.TRANSFORM]+=" rotate("+this.options.angle+"deg)";else if(f.Browser.ie){var t=this.options.angle*(Math.PI/180),o=Math.cos(t),n=Math.sin(t);this._icon.style.filter+=" progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', M11="+o+", M12="+-n+", M21="+n+", M22="+o+")"}},setAngle:function(e){this.options.angle=e}}),f.rotatedMarker=function(e,t){return new f.RotatedMarker(e,t)},f.edgeMarker=function(e){return new f.EdgeMarker(e)}}(L),L.TileLayer.Grayscale=L.TileLayer.extend({options:{quotaRed:21,quotaGreen:71,quotaBlue:8,quotaDividerTune:0,quotaDivider:function(){return this.quotaRed+this.quotaGreen+this.quotaBlue+this.quotaDividerTune}},initialize:function(e,t){(t=t||{}).crossOrigin=!0,L.TileLayer.prototype.initialize.call(this,e,t),this.on("tileload",function(e){this._makeGrayscale(e.tile)})},_createTile:function(){var e=L.TileLayer.prototype._createTile.call(this);return e.crossOrigin="Anonymous",e},_makeGrayscale:function(e){if(!e.getAttribute("data-grayscaled")){e.crossOrigin="";var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var o=t.getContext("2d");o.drawImage(e,0,0);for(var n=o.getImageData(0,0,t.width,t.height),r=n.data,a=0,i=r.length;a<i;a+=4)r[a]=r[a+1]=r[a+2]=(this.options.quotaRed*r[a]+this.options.quotaGreen*r[a+1]+this.options.quotaBlue*r[a+2])/this.options.quotaDivider();o.putImageData(n,0,0),e.setAttribute("data-grayscaled",!0),e.src=t.toDataURL()}}}),L.tileLayer.grayscale=function(e,t){return new L.TileLayer.Grayscale(e,t)},jQuery(document).ready(function(_){var M=function(e){var t=e.split("-");return"".concat(t[2],".").concat(t[1],".").concat(t[0],".")},C=L.tileLayer.grayscale("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}.png",{maxZoom:18,attribution:'<a href="https://wikimediafoundation.org/wiki/Maps_Terms_of_Use">Wikimedia</a>  &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),I=null,S=7.5;if("undefined"!=typeof rkgScript){var O=document.body.classList.contains("logged-in");console.log(O),I=!0===O?[44.3,16.5]:[44.3,15],_(window).width()<=1080&&(I=[44.4,16.3],S=6.5),_("#rkg-map").length&&function(){var n=L.map("rkg-map",{attributionControl:!1,zoomSnap:.25,gestureHandling:!0,gestureHandlingOptions:{text:{touch:"Koristi dva prsta za mapu",scroll:"ctrl + scroll",scrollMac:"âŒ˜ + scroll"}}}).setView(I,S);L.control.attribution({position:"bottomleft"}).addTo(n),n.addLayer(C);for(var r,t=_("#excursions").data("new"),o=_("#excursions").data("now"),a=_("#excursions").data("old"),i=L.divIcon({className:"now-div-icon",iconSize:[14,14]}),c=L.divIcon({className:"new-div-icon",iconSize:[14,14]}),s=L.divIcon({className:"old-div-icon",iconSize:[14,14]}),l=L.divIcon({className:"new-div-icon-active",iconSize:[20,20]}),d=L.divIcon({className:"now-div-icon-active",iconSize:[20,20]}),u=L.divIcon({className:"old-div-icon-active",iconSize:[20,20]}),g=L.layerGroup(),p=L.layerGroup(),m=L.layerGroup(),h={},f=L.layerGroup(),v=L.edgeMarker({icon:s,rotateIcons:!0,layerGroup:f,findEdge:function(){return L.bounds([0,0],r)}}),e=function(e){""!==o[e].longitude&&"0"!==o[e].longitude&&(h[o[e].id]=L.marker([o[e].latitude,o[e].longitude],{icon:i,id:o[e].id,old:!1,now:!0}),h[o[e].id].bindPopup('<b class="leaflet-popup-bold-now">'.concat(o[e].post_title,"</b><br>\n                ").concat(M(o[e].starttime)," - ").concat(M(o[e].endtime),"<br>\n                Organizator: ").concat(o[e].display_name,"<br>\n                Planirano osoba: ").concat(o[e].limitation)).on("mouseover",function(){h[o[e].id].setIcon(d)}).on("mouseout",function(){h[o[e].id].setIcon(i)}),g.addLayer(h[o[e].id]))},k=0;k<o.length;k++)e(k);g.addTo(n);var y=function(e){""!==t[e].longitude&&"0"!==t[e].longitude&&(h[t[e].id]=L.marker([t[e].latitude,t[e].longitude],{icon:c,id:t[e].id,old:!1,now:!1}),h[t[e].id].bindPopup('<b class="leaflet-popup-bold-new">'.concat(t[e].post_title,"</b><br>\n                ").concat(M(t[e].starttime)," - ").concat(M(t[e].endtime),"<br>\n                Organizator: ").concat(t[e].display_name,"<br>\n                Planirano osoba: ").concat(t[e].limitation)).on("mouseover",function(){h[t[e].id].setIcon(l)}).on("mouseout",function(){h[t[e].id].setIcon(c)}),p.addLayer(h[t[e].id]))};for(k=0;k<t.length;k++)y(k);p.addTo(n);var x=function(e){""!==a[e].longitude&&"0"!==a[e].longitude&&(h[a[e].id]=L.marker([a[e].latitude,a[e].longitude],{icon:s,id:a[e].id,old:!0,now:!1}),h[a[e].id].bindPopup('<b class="leaflet-popup-bold-old">'.concat(a[e].post_title,"</b><br>\n                ").concat(M(a[e].starttime)," - ").concat(M(a[e].endtime),"<br>\n                Organizator: ").concat(a[e].display_name,"<br>\n                Planirano osoba: ").concat(a[e].limitation)).on("mouseover",function(){h[a[e].id].setIcon(u)}).on("mouseout",function(){h[a[e].id].setIcon(s)}),m.addLayer(h[a[e].id]))};for(k=0;k<a.length;k++)x(k);m.addTo(n);var b=_("#excursions").offset();r=n.getSize(),1080<_(window).width()&&!0===O&&(r=[b.left,n.getSize().y]),L.edgeMarker({icon:i,rotateIcons:!0,layerGroup:g,findEdge:function(){return L.bounds([0,0],r)}}).addTo(n),L.edgeMarker({icon:c,rotateIcons:!0,layerGroup:p,findEdge:function(){return L.bounds([0,0],r)}}).addTo(n);var w,T=L.edgeMarker({icon:s,rotateIcons:!0,layerGroup:m,findEdge:function(){return L.bounds([0,0],r)}});T.addTo(n),n.on("popupopen",function(e){var t=e.popup._source.options,o=_("#excursion-".concat(t.id));if(console.log(o),o.addClass("active"),t.old){_(".excursion-new-container").hide(),_(".excursion-old-container").show(),_(".button-excursion-old").addClass("active"),_(".button-excursion-new").removeClass("active"),_(".excursion-gradient").addClass("old"),_("#excursions").addClass("excursions-old");var n=o.position().top;_(".excursion-old-container").scrollTop(n)}else{_(".excursion-old-container").hide(),_(".excursion-new-container").show(),_(".button-excursion-new").addClass("active"),_(".button-excursion-old").removeClass("active"),_(".excursion-gradient").removeClass("old"),_("#excursions").removeClass("excursions-old");var r=o.position().top;_(".excursion-new-container").scrollTop(r)}}),n.on("popupclose",function(){_(".excursion").removeClass("active")}),_(".excursion").hover(function(e){var t=_(e.currentTarget).data("marker"),o=h[t.id];o.options.old?o.setIcon(u):o.options.now?o.setIcon(d):o.setIcon(l),w=setTimeout(function(){n.panTo(o.getLatLng())},1e3)},function(e){var t=_(e.currentTarget).data("marker"),o=h[t.id];o.options.old?o.setIcon(s):o.options.now?o.setIcon(i):o.setIcon(c),clearTimeout(w)}),_(".excursion-block-btn").click(function(e){_(e.currentTarget).hide(),_(".excursion-block-search-btn").css("display","block"),_(".excursion-block-search").animate({height:"toggle",opacity:"toggle"},"fast")}),_("#excursion-block-search-form").submit(function(e){e.preventDefault();var t=e.currentTarget,o=new FormData(t);o.append("action","excursion_search"),m.remove(),T.destroy(),f.remove(),v.destroy(),jQuery.ajax({url:rkgScript.ajaxUrl,type:"POST",contentType:!1,processData:!1,dataType:"json",data:o,success:function(t){console.log(t),_(".excursion-old-container-list-serarch").html(t.html),_(".excursion-old-container-list-serarch").show(),_(".excursion-old-container-list").hide(),f=L.layerGroup();for(var e=function(e){h[t.cords[e].id]=L.marker([t.cords[e].latitude,t.cords[e].longitude],{icon:s,id:t.cords[e].id,old:!0,now:!1}),h[t.cords[e].id].bindPopup('<b class="leaflet-popup-bold-old">'.concat(t.cords[e].post_title,"</b><br>\n                ").concat(M(t.cords[e].starttime)," - ").concat(M(t.cords[e].endtime),"<br>\n                Organizator: ").concat(t.cords[e].display_name,"<br>\n                Planirano osoba: ").concat(t.cords[e].limitation)).on("mouseover",function(){h[t.cords[e].id].setIcon(u)}).on("mouseout",function(){h[t.cords[e].id].setIcon(s)}),f.addLayer(h[t.cords[e].id])},o=0;o<t.cords.length;o++)e(o);f.addTo(n),(v=L.edgeMarker({icon:s,rotateIcons:!0,layerGroup:f,findEdge:function(){return L.bounds([0,0],r)}})).addTo(n)}})}),_(".button-excursion-new").on("click",function(){m.addTo(n),T.addTo(n),f.remove(),v.destroy(),_(".excursion-block-btn").css("display","block"),_(".excursion-block-search-btn").css("display","none"),_(".excursion-block-search").hide(),_(".excursion-old-container-list-serarch").hide(),_(".excursion-old-container-list").show(),_(".excursion-old-container").hide(),_(".excursion-new-container").show(),_(".button-excursion-new").addClass("active"),_(".button-excursion-old").removeClass("active"),_(".excursion-gradient").removeClass("old"),_("#excursions").removeClass("excursions-old")}),_(".button-excursion-old").on("click",function(){m.addTo(n),T.addTo(n),f.remove(),v.destroy(),_(".excursion-block-btn").css("display","block"),_(".excursion-block-search-btn").css("display","none"),_(".excursion-block-search").hide(),_(".excursion-old-container-list-serarch").hide(),_(".excursion-old-container-list").show(),_(".excursion-new-container").hide(),_(".excursion-old-container").show(),_(".button-excursion-old").addClass("active"),_(".button-excursion-new").removeClass("active"),_(".excursion-gradient").addClass("old"),_("#excursions").addClass("excursions-old")}),_(".buton-excursion-mobile").on("click",function(e){m.addTo(n),T.addTo(n),f.remove(),v.destroy(),_(".excursion-block-btn").css("display","block"),_(".excursion-block-search-btn").css("display","none"),_(".excursion-block-search").hide(),_(".excursion-old-container-list-serarch").hide(),_(e.currentTarget).hasClass("old")?(_(e.currentTarget).removeClass("old"),_(e.currentTarget).addClass("new"),_(".excursion-old-container-list").show(),_(".excursion-new-container").hide(),_(".excursion-old-container").show(),_(".button-excursion-old").addClass("active"),_(".button-excursion-new").removeClass("active"),_(".excursion-gradient").addClass("old"),_("#excursions").addClass("excursions-old")):(_(e.currentTarget).removeClass("new"),_(e.currentTarget).addClass("old"),_(".excursion-old-container-list").show(),_(".excursion-old-container").hide(),_(".excursion-new-container").show(),_(".button-excursion-new").addClass("active"),_(".button-excursion-old").removeClass("active"),_(".excursion-gradient").removeClass("old"),_("#excursions").removeClass("excursions-old"))})}()}if(_("#rkg-admin-map").length){var t,o,n=L.divIcon({className:"leaflet-div-icon",iconSize:[14,14]});_("input[name=latitude]").val()?((t=L.map("rkg-admin-map").setView([_("input[name=latitude]").val(),_("input[name=longitude]").val()],15)).addLayer(C),o=L.marker([_("input[name=latitude]").val(),_("input[name=longitude]").val()],{icon:n}).addTo(t),t.addLayer(o)):(t=L.map("rkg-admin-map").setView([44.7,16],6)).addLayer(C);L.control.geocoder("bd35a36b680bdf",{bounds:!1,markers:!1,panToPoint:!1}).addTo(t).on("select",function(e){o&&t.removeLayer(o),t.setView(e.latlng,15),o=new L.Marker(e.latlng,{icon:n}),t.addLayer(o),_("input[name=latitude]").val(e.latlng.lat),_("input[name=longitude]").val(e.latlng.lng)}),t.on("click",function(e){o&&t.removeLayer(o),o=new L.Marker(e.latlng,{icon:n}),t.addLayer(o),_("input[name=latitude]").val(e.latlng.lat),_("input[name=longitude]").val(e.latlng.lng)})}if(_("#rkg-excursion-map").length){var e=_("#rkg-excursion-map").data("lat"),r=_("#rkg-excursion-map").data("long"),a=L.divIcon({className:"new-div-icon",iconSize:[14,14]}),i=L.map("rkg-excursion-map",{attributionControl:!1,zoomControl:!1,zoomSnap:.5,gestureHandling:!0,gestureHandlingOptions:{text:{touch:"Koristi dva prsta za mapu",scroll:"ctrl + scroll"}}}).setView([e,r],15),c=L.marker([e,r],{icon:a}).addTo(i);i.addLayer(C),i.addLayer(c)}_("#rkg_category").change(function(){_("#title-prompt-text").hide();var e=_("#rkg_category option:selected").data("template"),t=_("#rkg_category option:selected").val();if(_("#title").val(e.name),_("#rkg-location").val(e.location),_("#rkg-terms").val(e.terms),_("#rkg-price").val(e.price),_("#rkg-limitation").val(e.limitation),_("#wp-content-wrap").hasClass("html-active"))_("#content").val(e.description);else{var o=tinyMCE.get("content");null!==o&&o.setContent(e.description.replace(/\n\s*\n/g,"\n").replace(new RegExp("\r?\n","g"),"<br />"))}_("#rkg_organiser").children().removeAttr("selected"),_(".instructor-option").hide(),_("#instructor-".concat(t)).show(),_("#instructor-none").attr("selected","selected")}),_(".course-terms-control").click(function(){_(".course-terms").toggle(),_(".course-terms-up").toggle(),_(".course-terms-down").toggle()}),_(".rkg-course-slick").slick({infinite:!0,slidesToShow:3,slidesToScroll:3,prevArrow:_(".rkg-course-chevron-left"),nextArrow:_(".rkg-course-chevron-right"),responsive:[{breakpoint:1081,settings:{slidesToShow:1,slidesToScroll:1}}]}),_("#rkg-starttime").change(function(e){var t=_(e.currentTarget).val();_("#rkg-endtime").attr("min",t)}),_(".course-block-select").click(function(e){e.preventDefault();var t=_(e.currentTarget).data("target");_(".course-block-terms").not("#course-block-terms-".concat(t)).hide(),_("#course-block-terms-".concat(t)).animate({height:"toggle",opacity:"toggle"},"fast")}),_(document).mouseup(function(e){_(".course-block-select").is(e.target)||0!==_(".course-block-terms").has(e.target).length||_(".course-block-terms").hide()}),_(".course-block-term").click(function(e){e.preventDefault();var t=_(e.currentTarget).data("target"),o=_(e.currentTarget).data("id"),n=_(e.currentTarget).data("link"),r=_(e.currentTarget).data("date"),a=_(e.currentTarget).data("title"),i=_(e.currentTarget).data("content"),c=_(e.currentTarget).data("signdate"),s=_(e.currentTarget).data("signclass"),l=_(e.currentTarget).data("signtext");_("#course-block-link-".concat(t)).attr("href",n),_("#course-block-link-more-".concat(t)).attr("href",n),_("#course-block-date-".concat(t)).text(r),_("#course-block-title-".concat(t)).text(a),_("#course-block-content-".concat(t)).text(i),_("#course-block-signup-".concat(t)).removeClass(),_("#course-block-signup-".concat(t)).addClass(s),_("#course-block-signup-".concat(t)).text(l),_("#course-block-signup-".concat(t)).attr("data-course",o),_("#course-block-signup-".concat(t)).attr("data-name",a),_("#course-block-signup-".concat(t)).attr("data-date",c),_("#course-block-terms-".concat(t)).animate({height:"toggle",opacity:"toggle"},"fast")}),_("body").on("change","#file",function(e){var t=_(e.currentTarget).prop("files")[0],o=_("#userId").val(),n=new FormData;n.append("file",t),n.append("user",o),n.append("action","file_upload"),jQuery.ajax({url:rkgScript.ajaxUrl,type:"POST",contentType:!1,processData:!1,data:n,success:function(e){_("#brevetShow").attr("src",e)}})}),_("body").on("click",".rkg-news-category",function(e){var t=_(e.currentTarget).attr("data-id"),o=new FormData;o.append("id",t),o.append("action","news_block_update"),jQuery.ajax({url:rkgScript.ajaxUrl,type:"POST",contentType:!1,processData:!1,data:o,dataType:"json",success:function(e){_(".rkg-category-container").html(e.category),_(".news-content-container").fadeOut("fast").promise().done(function(){_(".news-content-container").html(e.content).fadeIn("fast")})},error:function(e){console.log(e)}})}),_(".rkg-category-container").on("click",".rkg-news-category-select",function(e){e.preventDefault();_(e.currentTarget).data("target");_(".rkg-news-category-select-arrow").toggleClass("up"),_(".rkg-news-category, .rkg-news-category-link").animate({height:"toggle",opacity:"toggle"},"fast")}),_("#misc-publishing-actions").after(_("#cancle_excursion")),_("#titlediv").before(_("#rkg_category_table")),_("#rkg_excursion_data_metabox, #rkg_course_data_metabox").detach().appendTo("#prenormal-sortables"),_(".new-inventory-icon").click(function(e){_(e.currentTarget).hide(),_(e.currentTarget).next().show()}),_(".reservation-resolve input[type=text]").focus(function(e){_(e.currentTarget).removeClass("ok no")}).blur(function(t){var e=_(t.currentTarget).val();console.log(e),_.ajax({type:"POST",dataType:"json",url:rkgScript.ajaxUrl,data:{action:"check_inventory",id:e},success:function(e){_(t.currentTarget).addClass(e)},error:function(e){console.log(e)}})}),_("label[for=role]").parent().parent().remove(),_("#guest_meta_check").on("change",function(e){1==_(e.currentTarget).prop("checked")?_("#guest_count_row").show():0==_(e.currentTarget).prop("checked")&&_("#guest_count_row").hide()}),_(".rkg-popover-control").click(function(e){_(".rkg-popover").not(_(e.currentTarget).next()).hide(),_(e.currentTarget).next().toggle()}),_("#niid, .preSignupSelect").select2(),_(".rkg-admin-switch").click(function(e){var t=_(e.currentTarget).attr("id");_(e.currentTarget).toggleClass("dashicons-arrow-down-alt2 dashicons-arrow-up-alt2"),_("#".concat(t,"-block")).toggle()}),_(".rkg-show-map").click(function(e){e.preventDefault(),_(e.currentTarget).toggleClass("on off"),_("#excursions").toggleClass("excursions-map-off")}),_(".rkg-toggler, .rkg-toggler-title").click(function(e){if("pointer"===_(e.currentTarget).css("cursor")){var t=_(e.currentTarget).data("toggle");_(e.currentTarget).find("i").toggleClass("fa-chevron-down fa-chevron-up"),_("#".concat(t)).toggle()}})});
//# sourceMappingURL=script.js.map
